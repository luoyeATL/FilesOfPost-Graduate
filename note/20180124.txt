基于宿主权限的移动广告漏洞攻击技术

关键字： 移动广告生态系统  宿主权限  中间人攻击  攻击载荷自动生成  能力描述语言

攻击方法：本文提出一种基于宿主权限的移动广告漏洞攻击方法，能够在移动应用获取广告内容时在流量中植入攻击代码.
         通过对广告流量的拦截，提取出宿主应用的标识和客户端相关信息、间接得到宿主应用的权限列表和当前设备
		 的WebView漏洞.

本文攻击方案的系统框架主要包括以下四个功能模块:
    (1)流量分析.该模块利用流量识别算法从普通网络流量中提取出广告流量，并且利用机器学习分类算法
        从广告流量中识别出宿主应用的标识和设备相关信息泡括名称、版本号等.
    (2)权限分析.该模块根据宿主应用的标识，利用爬虫工具从官方应用市场(Google Play Store)中获取其权
        限列表，确定攻击者在当前环境下的能力上限.
    (3)漏洞分析.该模块深入分析现有移动应用对广告库的隔离措施，并根据Android系统版本和设备相关
        信息确定待攻击广告库AdSDK的WebView安全漏洞，以绕过宿主应用对广告内容的隔离.
    (4)载荷生成.该模块根据宿主应用的权限和隔离措施的漏洞提出一种攻击者能力描述语言，能够自动生
        成可行的攻击载荷并植入到广告内容中返回客户端.
		 
对于本文的流量分析和识别方法，单纯的监督学习算法面临两个挑战:
    1、有标签流量样本稀少并且难以获得.在已知标签过少时，监督学习训练得到的分类算法可能无法覆盖
       到所有的特征，对于未知样本可能错误分类.
    2、并小是所有应用的流量特征都是固定的.随着版本的升级，应用产生的网络流量可能会发生变化，传统
       的有监督学习算法只能将已知的样本集分为q类，难以扩展到其他新的类别.
聚类:
    聚类分析是典型的无监督学习算法，能够从所有可用的网络数据流量中得到若干个聚类簇.一个聚类簇之
内的样本相似度较高，小同的聚类簇之问相似度较低.通过计算数据流之问的相似度，聚类分析能够识别出应用
和系统标识.

权限分析
    直观上，分析Android应用的权限列表可以通过对APK文件进行分析，从配置文件AndroidManifest.xml文件中获得.
但是本文攻击方案是在网络中实时运行，而小是在终端上离线分析.因此，攻击者无法直接获得当前宿主应用的APK文件.
为了解决这个问题，本文设计了一种从应用市场中分析元数据以得到权限列表的方法.观察发现，很多应用市场在推荐用
户安装时，除了给出应用的功能介绍以外，还会给出该应用的权限情况，以告知用户可能存在的安全风险.
    因此，通过对宿主应用元数据的爬取，攻击者在小需要静态分析的情况卜也能够快速得到该应用的权限列表.
    
漏洞分析
    本文主要关注7类Web View相关漏洞包括：WebView任意代码执行漏洞、WebView域控制小严格漏洞、
WebView File域同源策略绕过漏洞、web层同源策略解析漏洞、web层和本地层语义误差漏洞、外部存储
文件推测漏洞和其他侧信道攻击.

攻击载荷的生成步骤分为三个模块:
1)能力描述语言生成;
2)能力解析;
3)载荷生成.
