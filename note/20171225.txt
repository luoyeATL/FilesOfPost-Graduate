一种基于模糊哈希的Android变种恶意软件检测方法

关键字：Android变种 恶意软件检测 模糊哈希值

当前Android恶意软件检测及分类方法：
1、基于特征码的恶意代码检测方法
2、基于机器学习算法的恶意代码检测方法

本文通过自动化提取Apk中字符串以及函数长度分布信息来生成模糊哈希值，具有更高的抗干扰性，同时通过简化病毒库来提高检测速度。

在APK应用程序中，每一种类别APK都会有自己特有的字符串信息，在此通过解析dex文件可以提取其所使用的字符串

算法1：字符串特征向量生成
输入:初始化APK字符串集合S
输出:特征向量SV
while i<|S|
    si:=S[i];
    h=Hash(si);
    SV[h]=SV[h]+1;
end

在此以函数中所包含指令的字节数来表示其的长度。
我们以向量FV={fv1,fv2,...,fvm}来表示每个APK应用程序的函数特征。其中m表示该特征向量的长度，里面的每一项fvi表示该APK中
函数长度值属于某一区间内的函数数量。

令模糊哈希值FH=(SV,FV)，并以曼哈顿距离来度量两个模糊哈希值问的相似程度。

在实现对变种恶意软件检测时，我们首先计算病毒库中样本的模糊哈希值FH，利用k-means算法对模糊哈希值进行聚类，并将聚类后各
类别的质点来代表该类中其他所有点。